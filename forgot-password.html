<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mot de passe oubli√© - TeachInspire</title>
  <link rel="icon" type="image/png" href="https://imagedelivery.net/BGb25Nzj8sQ1HtrebC39dQ/134736d6-5e59-461d-8594-dbd8c8d6c400/public">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@400;500;600;700&family=Courier+New:wght@500&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'brand-bg': '#f8f7f2',
            'brand-text': '#2c3d57',
            'brand-primary-accent': '#85a2a3',
            'brand-secondary-accent': '#f1d263',
            'brand-card-bg': '#ffffff',
            'brand-muted-text': '#6b7280',
            'brand-error': '#ef4444',
            'brand-success': '#10b981',
            'brand-info': '#3b82f6',
          },
          fontFamily: {
            'playfair': ['Playfair Display', 'serif'],
            'inter': ['Inter', 'sans-serif'],
            'courier': ['Courier New', 'Courier', 'monospace'],
          },
          boxShadow: {
            'brand': '0 4px 6px -1px rgba(44, 61, 87,0.07), 0 2px 4px -2px rgba(44, 61, 87,0.07)',
            'brand-lg': '0 10px 15px -3px rgba(44, 61, 87, 0.1), 0 4px 6px -2px rgba(44, 61, 87, 0.05)'
          }
        }
      }
    }
  </script>
  <script type="importmap">
  {
    "imports": {
      "react": "https://esm.sh/react@^19.0.0",
      "react-dom/client": "https://esm.sh/react-dom@^19.0.0/client",
      "react-dom/": "https://esm.sh/react-dom@^19.0.0/",
      "react/": "https://esm.sh/react@^19.0.0/"
    }
  }
  </script>
</head>
<body class="bg-brand-bg">
  <div id="root"></div>
  <script type="module">
    import React from 'react';
    import { createRoot } from 'react-dom/client';
    import { translations } from './constants.js';
    
    // Simple language context for this standalone page
    const getInitialLanguage = () => {
      const urlParams = new URLSearchParams(window.location.search);
      const urlLang = urlParams.get('lang');
      const storedLang = localStorage.getItem('preferred-language');
      return urlLang || storedLang || 'fr';
    };

    const ForgotPasswordPage = () => {
      const [language, setLanguage] = React.useState(getInitialLanguage);
      const t = translations[language];

      const handleBackToLogin = () => {
        window.location.href = `/app.html?lang=${language}`;
      };

      const mockLanguageContext = {
        translations: {
          ...t,
          currentLanguage: language
        }
      };

      // Import and render ForgotPassword component
      return React.createElement('div', { className: 'min-h-screen bg-brand-bg' }, [
        // Language selector
        React.createElement('div', {
          key: 'language-selector',
          className: 'absolute top-4 right-4 z-10'
        }, [
          React.createElement('button', {
            key: 'fr-btn',
            onClick: () => setLanguage('fr'),
            className: `px-3 py-1 text-sm font-medium rounded-l-md border ${language === 'fr' ? 'bg-brand-primary-accent text-white border-brand-primary-accent' : 'bg-white text-brand-text border-gray-300 hover:bg-gray-50'}`
          }, 'FR'),
          React.createElement('button', {
            key: 'en-btn', 
            onClick: () => setLanguage('en'),
            className: `px-3 py-1 text-sm font-medium rounded-r-md border-l-0 border ${language === 'en' ? 'bg-brand-primary-accent text-white border-brand-primary-accent' : 'bg-white text-brand-text border-gray-300 hover:bg-gray-50'}`
          }, 'EN')
        ]),

        // Main content
        React.createElement('div', {
          key: 'main-content',
          className: 'min-h-screen flex items-center justify-center p-4'
        }, [
          React.createElement('div', {
            key: 'container',
            className: 'w-full max-w-md'
          }, [
            React.createElement('div', {
              key: 'card',
              className: 'bg-brand-card-bg rounded-lg shadow-brand-lg p-8'
            }, [
              React.createElement('div', {
                key: 'header',
                className: 'text-center mb-8'
              }, [
                React.createElement('img', {
                  key: 'logo',
                  src: 'https://res.cloudinary.com/ducvoebot/image/upload/v1747991665/Teachinspire_logo_transparent_yjt3uf.png',
                  alt: 'TeachInspire Logo',
                  className: 'mx-auto h-12 w-auto mb-4'
                }),
                React.createElement('h2', {
                  key: 'title',
                  className: 'text-2xl font-playfair font-bold text-brand-text mb-2'
                }, t.auth.forgotPassword.title),
                React.createElement('p', {
                  key: 'subtitle',
                  className: 'text-brand-muted-text'
                }, t.auth.forgotPassword.subtitle)
              ]),

              // Forgot Password Form Component will be rendered here
              React.createElement(ForgotPasswordForm, {
                key: 'form',
                translations: mockLanguageContext.translations,
                onBackToLogin: handleBackToLogin
              })
            ])
          ])
        ])
      ]);
    };

    // Forgot Password Form Component
    const ForgotPasswordForm = ({ translations, onBackToLogin }) => {
      const [email, setEmail] = React.useState('');
      const [isLoading, setIsLoading] = React.useState(false);
      const [isSuccess, setIsSuccess] = React.useState(false);
      const [error, setError] = React.useState('');

      const handleSubmit = async (e) => {
        e.preventDefault();
        
        if (!email.trim()) {
          setError(translations.auth.forgotPassword.emailRequired);
          return;
        }

        setIsLoading(true);
        setError('');

        try {
          const response = await fetch('/api/auth/forgot-password', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
              email: email.trim(),
              language: translations.currentLanguage
            }),
          });

          const data = await response.json();

          if (response.ok && data.success) {
            setIsSuccess(true);
          } else {
            setError(data.error?.message || translations.auth.forgotPassword.errorGeneric);
          }
        } catch (error) {
          console.error('Forgot password error:', error);
          setError(translations.auth.forgotPassword.errorGeneric);
        } finally {
          setIsLoading(false);
        }
      };

      if (isSuccess) {
        return React.createElement('div', { className: 'text-center' }, [
          React.createElement('div', {
            key: 'success-icon',
            className: 'w-16 h-16 bg-brand-success rounded-full flex items-center justify-center mx-auto mb-4'
          }, [
            React.createElement('svg', {
              key: 'check-icon',
              className: 'w-8 h-8 text-white',
              fill: 'none',
              stroke: 'currentColor',
              viewBox: '0 0 24 24'
            }, [
              React.createElement('path', {
                key: 'check-path',
                strokeLinecap: 'round',
                strokeLinejoin: 'round',
                strokeWidth: 2,
                d: 'M5 13l4 4L19 7'
              })
            ])
          ]),
          React.createElement('h3', {
            key: 'success-title',
            className: 'text-xl font-semibold text-brand-text mb-4'
          }, translations.auth.forgotPassword.successTitle),
          React.createElement('p', {
            key: 'success-message',
            className: 'text-brand-muted-text mb-6'
          }, translations.auth.forgotPassword.successMessage),
          React.createElement('button', {
            key: 'back-button',
            onClick: onBackToLogin,
            className: 'w-full bg-gradient-to-r from-brand-primary-accent to-brand-secondary-accent text-white py-3 px-6 rounded-full font-inter font-semibold hover:shadow-lg transition-all duration-200 transform hover:scale-105'
          }, translations.auth.forgotPassword.backToLogin)
        ]);
      }

      return React.createElement('form', {
        onSubmit: handleSubmit,
        className: 'space-y-6'
      }, [
        React.createElement('div', { key: 'email-field' }, [
          React.createElement('label', {
            key: 'email-label',
            htmlFor: 'email',
            className: 'block text-sm font-medium text-brand-text mb-2'
          }, translations.auth.forgotPassword.emailLabel),
          React.createElement('input', {
            key: 'email-input',
            type: 'email',
            id: 'email',
            value: email,
            onChange: (e) => setEmail(e.target.value),
            placeholder: translations.auth.forgotPassword.emailPlaceholder,
            className: 'w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-primary-accent focus:border-transparent transition-colors font-inter',
            disabled: isLoading,
            required: true
          })
        ]),
        
        error && React.createElement('div', {
          key: 'error',
          className: 'bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm'
        }, error),
        
        React.createElement('button', {
          key: 'submit-button',
          type: 'submit',
          disabled: isLoading,
          className: `w-full bg-gradient-to-r from-brand-primary-accent to-brand-secondary-accent text-white py-3 px-6 rounded-full font-inter font-semibold transition-all duration-200 transform ${isLoading ? 'opacity-50 cursor-not-allowed' : 'hover:shadow-lg hover:scale-105'}`
        }, isLoading ? translations.auth.forgotPassword.sending : translations.auth.forgotPassword.sendButton),
        
        React.createElement('div', {
          key: 'back-link',
          className: 'text-center'
        }, [
          React.createElement('button', {
            key: 'back-button',
            type: 'button',
            onClick: onBackToLogin,
            className: 'text-brand-primary-accent hover:text-brand-secondary-accent transition-colors font-medium text-sm'
          }, translations.auth.forgotPassword.backToLogin)
        ])
      ]);
    };

    // Mount the app
    const root = createRoot(document.getElementById('root'));
    root.render(React.createElement(ForgotPasswordPage));
  </script>
</body>
</html>